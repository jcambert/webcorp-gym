!function(a,b){"use strict";var c=a.module("angular.youtube",[]);c.run(["$rootScope","youtube.service",function(a,b){console.log("youtube module running"),a.$on("$stateChangeSuccess",function(a,b,c,d,e){"video"==b.name&&console.log("youtube video initialization")})}]),c.factory("playlists",["$resource",function(a){return a("https://www.googleapis.com/youtube/v3/playlists?part=:snippet&channelId=:channelId&key=:key")}]),c.factory("playlistItems",["$resource",function(a){return a("https://www.googleapis.com/youtube/v3/playlistItems?part=:snippet&playlistId=:playlistId&key=:key")}]),c.service("youtube.service",["$rootScope","$http","$q","playlists","playlistItems",function(a,c,d,e,f){this.getPlaylists=function(c,f,g){var h=d.defer();if(a.gapi.login){var i=b.client.youtube.playlists.list(g);i.execute(function(a){a.items&&h.resolve(a.items),h.reject({})})}else e.get({snippet:g.part||"snippet",channelId:c,key:f},function(a){console.dir(a),h.resolve(a)});return h.promise},this.getPlaylistItems=function(b,c,e){var g=d.defer();return a.gapi.login?request.execute(function(a){a.items&&g.resolve(a.items),g.reject({})}):f.get({snippet:e.part||"snippet",playlistId:b,key:c},function(a){console.dir(a),g.resolve(a)}),g.promise}}])}(angular,gapi),!function(a){"use strict";var b=a.module("angular.gapi",[]);b.run(function(){console.log("gapi running")}),b.factory("GClient",["$document","$q","$timeout","$interval","$window",function(a,b,c,d,e){function f(d){var e=b.defer(),f=a[0].createElement("script");return f.onload=function(a){c(function(){e.resolve(a)})},f.onerror=function(a){c(function(){e.reject(a)})},f.src=d,a[0].body.appendChild(f),e.promise}function g(a){f(i).then(function(){var b=function(a){void 0!=e.gapi.client&&(a(),d.cancel(c))};b(a);var c=d(function(){b(a)},10);h=!0})}var h=!1,i="https://apis.google.com/js/client.js";return{get:function(a){h?a():g(a)}}}]),b.factory("GData",["$rootScope",function(a){a.gapi={};var b=!1,c=null;return{isLogin:function(c){return 0==arguments.length?b:(b=c,void(a.gapi.login=c))},getUser:function(b){return 0==arguments.length?c:(c=b,void(a.gapi.user=b))}}}]),b.factory("GAuth",["$rootScope","$q","GClient","GApi","GData","$interval","$window","$location",function(a,b,c,d,e,f,g){function h(a){if(0==m){var b=arguments.length;c.get(function(){g.gapi.client.load("oauth2","v2",function(){m=!0,1==b&&a()})})}else a()}function i(a,b){h(function(){g.gapi.auth.authorize({client_id:l,scope:n,immediate:a,response_type:o},b)})}function j(){function a(b){if("https://accounts.google.com"===b.origin){var e=JSON.parse(b.data);g.removeEventListener("message",a),e=c(e.a[0],"code"),void 0==e?d.reject():d.resolve(e)}}function c(a,b){b=b.replace(/[[]/,"[").replace(/[]]/,"]");var c=b+"=([^&#]*)",d=new RegExp(c),e=d.exec(a);return null==e?void 0:e[1]}var d=b.defer(),e=$location.protocol+"//"+$location.hostname;""!=$location.port&&(e=e+":"+$location.port);g.open("https://accounts.google.com/o/oauth2/auth?scope="+encodeURI(n)+"&redirect_uri=postmessage&response_type=code&client_id="+l+"&access_type=offline&approval_prompt=force&origin="+e,null,"width=800, height=600");return g.addEventListener("message",a),d.promise}function k(){var a=b.defer();return g.gapi.client.oauth2.userinfo.get().execute(function(b){if(b.code)a.reject();else{e.isLogin(!0),d.executeCallbacks();var c={};c.email=b.email,c.picture=b.picture,c.id=b.id,void 0==b.name?c.name=b.email:c.name=b.name,c.link=b.link,e.getUser(c),a.resolve()}}),a.promise}var l,m=!1,n="https://www.googleapis.com/auth/userinfo.email",o="token id_token";return{setClient:function(a){l=a},setScope:function(a){n=a},load:function(a){var b=arguments.length;c.get(function(){g.gapi.client.load("oauth2","v2",function(){1==b&&a()})})},checkAuth:function(){var a=b.defer();return i(!0,function(){k().then(function(){a.resolve()},function(){a.reject()})}),a.promise},login:function(){var a=b.defer();return i(!1,function(){k().then(function(){a.resolve()},function(){a.reject()})}),a.promise},setToken:function(a){var c=b.defer();return h(function(){g.gapi.auth.setToken(a),k().then(function(){c.resolve()},function(){c.reject()})}),c.promise},getToken:function(){var a=b.defer();return h(function(){a.resolve(g.gapi.auth.getToken())}),a.promise},logout:function(){var a=b.defer();return h(function(){g.gapi.auth.setToken(null),e.isLogin(!1),e.getUser(null),a.resolve()}),a.promise},offline:function(){var a=b.defer();return j().then(function(b){a.resolve(b)},function(){a.reject()}),a.promise}}}]),b.factory("GApi",["$q","GClient","GData","$window",function(a,b,c,d){function e(a,b,c,d,e){var f={};f.api=a,f.apiLoad=!1,f.method=b,f.params=c,f.auth=d,f.deferred=e,k.push(f)}function f(a,c,e){b.get(function(){d.gapi.client.load(a,c,function(){console.log(a+" "+c+" api loaded"),j.push(a),g(a)},e)})}function g(a){for(var b=a,d=0;d<k.length;d++){var e=k[d];e.api!=b&&!e.apiLoad||0!=e.auth&&1!=c.isLogin()?e.api==b&&(k[d].apiLoad=!0):(h(e.api,e.method,e.params,e.deferred),d>-1&&k.splice(d--,1))}}function h(a,b,c,e){for(var f=b.split("."),a=d.gapi.client[a],g=0;g<f.length;g++)a=a[f[g]];a(c).execute(function(a){a.error?e.reject(a):e.resolve(a)})}function i(b,c,d,f){var g=a.defer();return j.indexOf(b)>-1?h(b,c,d,g):e(b,c,d,f,g),g.promise}var j=[],k=[];return{executeCallbacks:function(){g()},load:function(a,b,c){f(a,b,c)},execute:function(a,b,c){return 3==arguments.length?i(a,b,c,!1):2==arguments.length?i(a,b,null,!1):void 0},executeAuth:function(a,b,c){return 3==arguments.length?i(a,b,c,!0):2==arguments.length?i(a,b,null,!0):void 0}}}])}(angular);var CLIENT_KEY="474879262930-7smn8osaaaq97iob9v22mmflnt2tmvh3.apps.googleusercontent.com",API_KEY="AIzaSyBav3gF1spxn-jyuUiZ_dDQ0n49lnRmByE",CHANNEL_ID="UCoCCSXjx4rTME6jpdYCj4XQ";!function(a){"use strict";var b=a.module("gymapp",["ngResource","ui.router","ngSanitize","com.2fdevs.videogular","com.2fdevs.videogular.plugins.controls","com.2fdevs.videogular.plugins.overlayplay","com.2fdevs.videogular.plugins.poster","info.vietnamcode.nampnq.videogular.plugins.youtube","angular.gapi","angular.youtube"]);b.config(["$stateProvider","$urlRouterProvider","$locationProvider",function(a,b,c){b.otherwise("/"),a.state("index",{url:"/",views:{front:{templateUrl:"partials/index.html"},back:{template:""}}}).state("qui",{url:"/qui",views:{front:{template:""},back:{templateUrl:"partials/qui.html"}}}).state("rejoindre",{url:"/rejoindre",views:{front:{template:""},back:{templateUrl:"partials/rejoindre.html"}}}).state("action",{url:"/action",views:{front:{template:""},back:{templateUrl:"partials/action.html"}}}).state("actu",{url:"/actu",views:{front:{template:""},back:{templateUrl:"partials/actu.html"}}}).state("agenda",{url:"/agenda",views:{front:{template:""},back:{templateUrl:"partials/agenda.html"}}}).state("video",{url:"/video",views:{front:{template:""},back:{templateUrl:"/partials/video.html"}}}).state("video.playlists",{url:"/playlists",templateUrl:"/partials/video.playlists.html"}).state("video.playlist",{url:"/playlist/:playlistid",templateUrl:"/partials/video.playlist.html",controller:"VideoPlaylistCtrl"}).state("video.play",{url:"/play/:videoid",templateUrl:"/partials/video.play.html",controller:"VideoPlayerCtrl",controllerAs:"controller"}).state("photo",{url:"/photo",views:{front:{template:""},back:{templateUrl:"partials/photo.html"}}}).state("lien",{url:"/lien",views:{front:{template:""},back:{templateUrl:"partials/lien.html"}}}).state("temp",{url:"/temp",views:{front:{template:""},back:{templateUrl:"/partials/temp.html"}}}),window.history&&window.history.pushState&&c.html5Mode({enabled:!0,requireBase:!1})}]),b.run(["$rootScope","$state","GApi","GAuth","youtube.service",function(a,b,c,d,e){d.setClient(CLIENT_KEY),c.load("oauth2","v2"),c.load("youtube","v3"),d.setScope("https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/youtube https://www.googleapis.com/auth/youtube.force-ssl https://www.googleapis.com/auth/youtube.readonly https://www.googleapis.com/auth/youtubepartner https://www.googleapis.com/auth/calendar.readonly"),a.$on("$stateChangeSuccess",function(b,c,d,f,g){"video.playlists"==c.name?e.getPlaylists(CHANNEL_ID,API_KEY,{part:"snippet"}).then(function(b){a.playlists=b,console.dir(a.playlists)},function(){console.log("Playlist not retrieved")}):"video.playlist"==c.name&&console.dir(c)}),console.log("running...")}]),b.controller("MainCtrl",["$scope","GAuth","$state",function(a,b,c){a.flipped=!0,a.flip=function(){a.flipped=!a.flipped},a.$on("$stateChangeSuccess",function(b,c,d,e,f){("video.playlists"!=e.name||"video.playlist"!=c.name)&&("video.playlist"!=e.name||"video.play"!=c.name)&&a.flip()}),a.doSignup=function(){b.login().then(function(){c.go("index")},function(){console.log("login fail")})},a.doSignout=function(){b.logout().then(function(){console.log("user is log out")})}}]),b.directive("page",[function(){return{replace:!0,restrict:"E",transclude:!0,scope:{title:"@title"},templateUrl:"partials/page.html"}}]),b.directive("pageHead",[function(){return{replace:!0,restrict:"E",require:"^page",template:""}}]),b.directive("pageContent",[function(){return{replace:!0,restrict:"E",require:"^page",template:""}}]),b.directive("deferredCloak",[function(){return{restrict:"A",link:function(a,b,c){c.$set("deferredCloak",void 0),b.removeClass("deferred-cloak")}}}]),b.directive("home",[function(){return{replace:!0,restrice:"E",template:'<a href="#" ui-sref="index" class="home"><i class="fa fa-home fa-5x"></i></a>'}}]),b.directive("logo",["$compile",function(b){return{replace:!0,restrict:"E",link:function(c,d,e){var f=a.element('<a class="navbar-brand pull-left logo" ><img alt="logo"></a>');"view"in e&&f.attr("ui-sref",e.view),"image"in e&&f.find("img").attr("src",e.image),d.html(f),b(f)(c)}}}]),b.directive("login",["$rootScope",function(a){return{replace:!0,restrict:"E",template:'<a href="#" ng-click="doSignup()" ng-hide="gapi.user!=undefined" class="login"><i class="fa fa-3x fa-user"></i></a>'}}]),b.directive("follow",["$compile",function(b){return{replace:"true",restrict:"E",link:function(c,d,e){var f=a.element('<div class="g-follow" data-annotation="bubble" data-height="24" data-href="//plus.google.com/u/0/'+e.who+'" data-rel="publisher"></div>');d.html(f),b(f)(c)}}}]),b.directive("user",[function(){return{replace:!0,restrict:"E",template:'<a href="#" ng-click="doSignout()" ng-if="gapi.user!=undefined" class="user"><img ng-src="{{gapi.user.picture}}"/></a>'}}]),b.directive("socials",["configuration",function(a){return{replace:!0,transclude:!0,restrict:"E",template:'<div ng-repeat="(key,value) in socials"><a href="#" ng-click="navigate(value)" class="social"><i class="fa fa-2x fa-{{key}}"></i></a></div>',controller:function(b){b.navigate=function(a){window.open(a,"_blank")},b.socials=a.socials}}}]),b.directive("tiles",["$compile",function(b){return{replace:!0,restrict:"E",link:function(c,d,e){var f=a.element("<div></div>");_.map(c.tiles,function(b){var c=a.element("<tile "+b.size+' color="'+b.color+'" ui-sref="'+b.state+'"></tile'),d=a.element('<a href="#"></a>');d.append("<h2>"+b.title+"</h2>"),d.append('<i class="fa fa-3x fa-'+b.icon+'"/>'),c.append(d),f.append(c)}),d.html(f),b(f)(c)}}}]),b.directive("tile",[function(){return{replace:!0,transclude:!0,restrict:"E",scope:{color:"@color",state:"="},template:'<div ><div ng-transclude class="thumbnail tile"></div></div>',link:function(a,b,c){b.find("div").addClass("tile-"+a.color),"state"in c?a.state=c.state:a.state="index"}}}]),b.directive("videoPlaylists",[function(){return{replace:!0,restrict:"E",scope:{playlists:"=playlists",size:"@size"},template:'<video-playlist ng-repeat="playlist in playlists" tile-size="wide" title="{{playlist.snippet.title}}" description="{{playlist.snippet.description}}" img="{{playlist.snippet.thumbnails.medium.url}}" playlistid="{{playlist.id}}"></video-playlist>'}}]),b.directive("videoPlaylist",[function(){return{replace:!0,restrict:"E",scope:{title:"@title",description:"@description",img:"@img",size:"@size",playlistid:"@playlistid"},templateUrl:"/partials/video.playlist.tile.html"}}]),b.directive("videoPlaylistItems",[function(){return{replace:!0,restrict:"E",scope:{playlistitems:"=playlistitems",size:"@size"},template:'<div><div ng-repeat="item in playlistitems.items"><video-playlist-item videoid="{{item.snippet.resourceId.videoId}}" title="{{item.snippet.title}}" description="{{item.snippet.description}}" img="{{item.snippet.thumbnails.medium.url}}"/></div></div>'}}]),b.directive("videoPlaylistItem",[function(){return{replace:!0,restrict:"E",scope:{videoid:"@videoid",title:"@title",description:"@description",img:"@img"},templateUrl:"/partials/video.playlistitem.tile.html"}}]),b.directive("tileSize",[function(){return{replace:!0,restrict:"A",link:function(a,b,c){"wide"==c.tileSize?(b.addClass("col-xs-12 col-sm-4 col-md-6 col-lg-4"),b.find("div").addClass("tile-wide")):"medium"==c.tileSize&&(b.addClass("col-xs-6 col-sm-2 col-md-3 col-lg-2"),b.find("div").addClass("tile-medium"))}}}]),b.directive("wide",[function(){return{replace:!0,restrict:"A",link:function(a,b,c){b.addClass("col-xs-12 col-sm-4 col-md-6 col-lg-4"),b.find("div").addClass("tile-wide")}}}]),b.directive("medium",[function(){return{replace:!0,restrict:"A",link:function(a,b,c){b.addClass("col-xs-6 col-sm-2 col-md-3 col-lg-2"),b.find("div").addClass("tile-medium")}}}]),b.service("configuration",[function(){this.socials={facebook:"https://www.facebook.com/avenirgrandvillars","google-plus":"https://plus.google.com/u/0/+AvenirGrandvillars",youtube:"https://www.youtube.com/user/AvenirDeGrandvillars"}}]),b.controller("TilesCtrl",["$scope",function(a){a.tiles=[{size:"wide",color:"amethyst",state:"qui",title:"Qui sommes-nous?",icon:"heart"},{size:"medium",color:"pink",state:"rejoindre",title:"Rejoindre",icon:"user-plus"},{size:"medium",color:"magenta",state:"action",title:"Actions",icon:"trophy"},{size:"wide",color:"asbestos",state:"actu",title:"Actualités",icon:"newspaper-o"},{size:"wide",color:"wisteria",state:"agenda",title:"Agenda",icon:"calendar"},{size:"wide",color:"magenta",state:"video.playlists",title:"Vidéos",icon:"youtube"},{size:"wide",color:"teal",state:"photo",title:"Photos",icon:"picture-o"},{size:"wide",color:"turquoise",state:"lien",title:"Liens",icon:"external-link"}]}]),b.directive("flipper",["$rootScope","$timeout",function(a,b){return{restrict:"E",template:'<div class="flipper " ng-transclude ng-class="{ flipped: flipped }"></div>',transclude:!0,scope:{flipped:"="}}}]),b.directive("front",["$compile",function(a){return{restrict:"E",scope:{view:"="},template:"<div class='front tileflip' ui-view='{{view}}' ></div>",transclude:!0,link:function(a,b,c){a.view=c.view}}}]),b.directive("back",function(){return{restrict:"E",scope:{view:"="},template:"<div class='back tileflip' ui-view='{{view}}' ></div>",transclude:!0,link:function(a,b,c){a.view=c.view}}}),b.controller("VideoCtrl",["$sce","$rootScope",function(a,b){}]),b.controller("VideoPlaylistCtrl",["$scope","$stateParams","youtube.service",function(a,b,c){console.dir(b);var d=b.playlistid;c.getPlaylistItems(d,API_KEY,{part:"snippet"}).then(function(b){a.playlistitems=b,console.log("items"),console.dir(a.playlistitems)})}]),b.controller("VideoPlayerCtrl",["$scope","$stateParams","$sce",function(a,b,c){console.log("VideoPlayerCtrl initilized: "+b.videoid),this.config={preload:"none",sources:[{src:"https://www.youtube.com/watch?v="+b.videoid}],theme:"../../bower_components/videogular-themes-default/videogular.css",plugins:{controls:{autoHide:!0,autoHideTime:5e3}}}}])}(angular,_);